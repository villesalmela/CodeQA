{% extends 'base.html' %}
{% block head %}{{ codemirror.include_codemirror() }}{% endblock %}
{% block title %}Code QA{% endblock %}
{% block body %}
<h1>Add new function</h1>
<p>To add a new function to the library, you will go through the following steps:</p>
<ol>
    <li>Static checking
        <ul>
            <li>Linting with pylint</li>
        </ul>
    </li>
    <li>Generating documentation
        <ul>
            <li>enhance your source code with comments and docstrings generated by OpenAI</li>
        </ul>
    </li>
    <li>Generating and running unit tests
        <ul>
            <li>generate unit tests with OpenAI</li>
            <li>run those tests with python standard library 'unittest' in AWS Lambda</li>
        </ul>
    </li>
    <li>Classifying
        <ul>
            <li>give your function a name and describe its use case</li>
            <li>generate a list of relevant keywords with OpenAI</li>
        </ul>
    </li>
</ol>

<h1>Linting</h1>
<p>You can click linting results to highlight the relevant part in code editor. Feel free to make adjustments and run the linting again.</p>
{% if form.errors %}
<ul class="errors">
    {% for field_name, field_errors in form.errors|dictsort if field_errors %}
    {% for error in field_errors %}
    <li>{{ form[field_name].label }}: {{ error }}</li>
    {% endfor %}
    {% endfor %}
</ul>
{% endif %}
<form method="POST" action="/add">
    {{ form.csrf_token }}
    {{ form.code.label }}: {{ form.code }}
    {{ form.lint }} {{ form.doc }}
</form>
{% if post %}
<h2>Linting Results</h2>
{% if lint_result %}
<table>
    <thead>
        <tr>
            <th>Type</th>
            <th>Object</th>
            <th>Message</th>
            <th>Description</th>
            <th>Startline</th>
            <th>Endline</th>
        </tr>
    </thead>
    <tbody>
        {% for item in lint_result %}
        <tr onclick="pylintRowClicked(this)">
            <td>{{ item.type }}</td>
            <td>{{ item.obj }}</td>
            <td>{{ item.message }}</td>
            <td>{{ item.description }}</td>
            <td>{{ item.line }}</td>
            <td>{{ item.endLine }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No errors or warnings.</p>
{% endif %}
{% endif %}
<script src="/static/functions.js"></script>
{% endblock %}